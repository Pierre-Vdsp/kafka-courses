### **4. Développement avec Kafka**

#### **Producers et Consumers en Java**
- **Configuration des clients Kafka** :
  Pour configurer un producteur ou un consommateur Kafka en Java, vous devez ajouter les dépendances Kafka à votre projet (par exemple, via Maven ou Gradle). Ensuite, configurez les propriétés nécessaires comme `bootstrap.servers` (adresse des brokers Kafka), `key.serializer`, `value.serializer` pour les producteurs, et `key.deserializer`, `value.deserializer` pour les consommateurs. Voici un exemple de configuration pour un producteur :
  ```java
  Properties props = new Properties();
  props.put("bootstrap.servers", "localhost:9092");
  props.put("key.serializer", "org.apache.kafka.common.serialization.StringSerializer");
  props.put("value.serializer", "org.apache.kafka.common.serialization.StringSerializer");
  Producer<String, String> producer = new KafkaProducer<>(props);
  ```

- **Envoi et réception de messages** :
  Pour envoyer des messages, utilisez la méthode `send` du producteur Kafka :
  ```java
  producer.send(new ProducerRecord<String, String>("my-topic", "key", "value"));
  ```
  Pour recevoir des messages, configurez un consommateur et utilisez la méthode `poll` :
  ```java
  Properties props = new Properties();
  props.put("bootstrap.servers", "localhost:9092");
  props.put("group.id", "test-group");
  props.put("key.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");
  props.put("value.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");
  Consumer<String, String> consumer = new KafkaConsumer<>(props);
  consumer.subscribe(Arrays.asList("my-topic"));
  while (true) {
      ConsumerRecords<String, String> records = consumer.poll(Duration.ofMillis(100));
      for (ConsumerRecord<String, String> record : records) {
          System.out.printf("offset = %d, key = %s, value = %s%n", record.offset(), record.key(), record.value());
      }
  }
  ```

#### **Kafka Streams**
- **Traitement de flux en temps réel** :
  Kafka Streams permet de traiter des flux de données en temps réel en utilisant des API de haut niveau. Vous pouvez définir des topologies de traitement qui incluent des opérations comme les filtres, les mappages et les agrégations.

- **Exemples de transformations de flux** :
  Voici un exemple simple de transformation de flux avec Kafka Streams :
  ```java
  Properties props = new Properties();
  props.put(StreamsConfig.APPLICATION_ID_CONFIG, "streams-example");
  props.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, "localhost:9092");
  props.put(StreamsConfig.DEFAULT_KEY_SERDE_CLASS_CONFIG, Serdes.String().getClass());
  props.put(StreamsConfig.DEFAULT_VALUE_SERDE_CLASS_CONFIG, Serdes.String().getClass());
  StreamsBuilder builder = new StreamsBuilder();
  KStream<String, String> source = builder.stream("input-topic");
  KStream<String, String> transformed = source.mapValues(value -> value.toUpperCase());
  transformed.to("output-topic");
  KafkaStreams streams = new KafkaStreams(builder.build(), props);
  streams.start();
  ```

#### **Kafka Connect**
- **Connexion à des sources et des sinks de données** :
  Kafka Connect facilite l'intégration de Kafka avec d'autres systèmes de données. Vous pouvez utiliser des connecteurs pour importer des données depuis des bases de données, des systèmes de fichiers, etc., et exporter des données vers des systèmes de stockage.

- **Utilisation de connecteurs prédéfinis** :
  Kafka Connect propose de nombreux connecteurs prédéfinis pour des systèmes courants comme JDBC, HDFS, Elasticsearch, etc. Pour utiliser un connecteur, vous devez configurer un fichier de propriétés spécifique au connecteur et le démarrer via l'API REST de Kafka Connect. Par exemple, pour un connecteur JDBC :
  ```json
  {
    "name": "jdbc-sink-connector",
    "config": {
      "connector.class": "io.confluent.connect.jdbc.JdbcSinkConnector",
      "tasks.max": "1",
      "topics": "my-topic",
      "connection.url": "jdbc:mysql://localhost:3306/mydb",
      "connection.user": "user",
      "connection.password": "password",
      "auto.create": "true"
    }
  }
  ```

(1) github.com. https://github.com/vikasdubeyyy/hello-producer/tree/ef4243c3076c484522b3b300df4ed47608357686/src%2Fmain%2Fjava%2Fin%2Fflyspark%2Fproducer%2Fcustomserializer%2FSupplierProducer.java.
(2) github.com. https://github.com/overskyline/Skyline-Traffic/tree/ba2c1272ff40a02dab3496627bf31e4d105c1ab3/src%2Fmain%2Fscala%2Fcom%2Fyi%2Fsimulator%2FStreamingDataSimulator.java.
(3) github.com. https://github.com/neuliuxiaoxiao/learn/tree/fbb1d2a777c660a7488e05a340999a0cb82de166/src%2Fmain%2Fjava%2Fneu%2Fkafka%2FProducerClient.java.
(4) github.com. https://github.com/iris-yue-wang/mytweetsanalyser/tree/e7cd7fbd5986b41c29e50ee8114fbc19850ecf1a/src%2Fmain%2Fjava%2Fcom%2Firis%2FTweetsCollector.java.
(5) github.com. https://github.com/zhang-da/java-skills/tree/1974ae0d531d9a08e2552c5726f6726c96d2edf1/learn-bigdata%2Flearn-flink%2Fsrc%2Fmain%2Fjava%2Fcom%2Fda%2Flearn%2Fflink%2FPointMain4.java.
(6) github.com. https://github.com/niexiongding/log4j-rabbit-kafka-json/tree/c004f8010cd2f7d7fc353f95056f46c212de652a/src%2Fmain%2Fjava%2Fcom%2Fkafka%2Fjava%2FConsumerDemo.java.
(7) github.com. https://github.com/stevenclaro/mq/tree/e17b1caebf8c265dab09e01252be476b6eb75160/kafka%2Fsrc%2Fmain%2Fjava%2Forg%2Fstudy%2Fmq%2Fkafka%2Fjava%2FConsumerSample.java.
(8) github.com. https://github.com/gaonl/kafka-client-test/tree/edc5105dca5047437238f31312fa73d6729f04d0/src%2Fmain%2Fjava%2Fnet%2Fmagicli%2Fconsumer%2FMagicliConsumer.java.
(9) github.com. https://github.com/adzubla/effective-carnival/tree/01a76d47b3b9aa6fbadcc901dfbe66dc64860acb/kafka-test%2Fsrc%2Fmain%2Fjava%2Fcom%2Fexample%2Fkafka%2Fsimple%2FTestConsumer.java.
(10) github.com. https://github.com/ynthm/spring-tools-demo/tree/284aa1a73d64ad4f872a1c3a42a2e673aa77697f/kafka%2Fsrc%2Ftest%2Fjava%2Fcom%2Fynthm%2Fkafka%2FKafkaClientsTests.java.
(11) github.com. https://github.com/MiniSC/Torison/tree/fffe0bb9649fc9ff32bfb898eb872881923c0289/com.torison.UpDown%2Fupdown-consumer%2Fsrc%2Fmain%2Fjava%2Fconsumer.java.
(12) github.com. https://github.com/chrissearle/kafka-java-to-scala/tree/8ef389e42da58aa3b56d69bcc23178611f31f7d0/articles%2F2-java.md.
(13) github.com. https://github.com/flychentao/streamTest/tree/205bc7d258214ef26b3e55ab61718490c2181a95/src%2Forg%2Fapache%2Fkafka%2Fstreams%2Fexamples%2Fpipe%2FPipeDemo.java.
(14) github.com. https://github.com/yudi-corgi/java_framework_summary/tree/63d76e178c405b0227005d9710d1b7de73746cd4/summary-kafka%2Fsrc%2Fmain%2Fjava%2Fcom%2Fdemo%2Fallframework%2Fkafka%2Fstream%2FWordCountOfficial.java.
(15) github.com. https://github.com/wankaiss/streams-quickstart-java/tree/f54e435aa0b966475f8af7d7466fd86daaa0c365/src%2Fmain%2Fjava%2Fmyapps%2FLineSpilt.java.